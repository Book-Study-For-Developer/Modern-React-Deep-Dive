# 1. 크롬 개발자 도구

- 크롬에서 제공하는 개발자용 도구
- 확장 프로그램의 영향이 덜한 시크릿모드/프라이빗 모드 추천

# 2. 요소 탭

- 웹페이지를 구성하는 HTML을 요소별로 확인 가능
- 리로드 없이 DOM, CSS 변경 및 확인 가능
- 특정 요소가 렌더링되는 시점을 중단점으로 잡을 수도 있음. 소스코드 확인 가능

# 3. 소스 탭

- 웹 애플리케이션을 불러오기 위해 실행하거나 참조된 모든 파일 확인 가능
- 중단점(breakpoint): 해당 위치에서 실행 일시 중지
- **감시**: 변수 추적
- **범위**: 로컬 스코프, 클로저, 전역 스코프 등 중단점을 기준으로 확인 가능한 모든 범위의 값을 확인할 수 있음
- **호출 스택**: 콜스택 확인
- 전역 리스너: 전역 스코프에 추가된 리스너 목록

# 4. 네트워크 탭

- 웹페이지가 외부 데이터와 통신하는 정보 확인 가능
- 스크린숏 캡처 기능: 네트워크 요청 흐름에 따라 페이지가 어떻게 로딩되는지 보여줌

### 확인해야 할 사항

- 불필요한 요청 또는 중복되는 요청
- 리소스 크기
- 리소스 다운로드 속도
- 리소스 다운로드 우선순위

# 5. **메모리 탭**

- 메모리 관련 정보 확인 가능
- 메모리 누수, 속도 저하, 웹피이지 프리징 현상 확인

### 힙 스냅샷

- 메모리 상황을 사진 찍듯이 촬영
- 일정 시간이 지난 후 다시 찍어서, 두 스냅샷 사이의 메모리 증가를 비교하는 방법
- 특정 객체가 어떤 함수의 산출물인지, 어떤 값을 가지고 있는지 확인 가능(전역 변수로 저장시)
- '얕은 크기(객체 자체의 크기)'는 작은데 '유지된 크기(객체가 참조하고 있는 모든 객체들의 크기)'가 클수록 메모리 누수 원인일 확률이 높다.

### 타임라인 할당 계측

- 시간의 흐름에 따른 메모리 변화 확인

### 할당 샘플링

- 할당 계측과 유사하지만 자바스크립트 실행 스택별로 분석 가능
  - 함수명부터 해당 소스 코드까지 확인 가능
- 장시간 디버깅 용이

### + 메모리 누수가 발생하는 지점들

- 클로저의 잘못된 사용
- 의도치않게 생성된 전역 변수
- 분리된 DOM 노드
- 콘솔 출력
- 해제하지 않은 타이머

### + 메모리 누수 분석을 돕는 라이브러리

결국 스냅샷 비교, 분석은 개발자의 몫인 것 같은데 이를 좀 더 수월하게 할 수 있는 방법이 없을까해서 찾아봤습니다. 아래와 같은 것들이 있다고 하네요.

- heapdump: Node.js 애플리케이션의 힙 덤프를 수집하고, 이를 크롬 개발자 도구와 같은 도구에서 분석할 수 있도록 함
- memwatch-next: Node.js 애플리케이션에서 메모리 누수 감지, 누수 발생 시 이벤트를 발생시킴
- node-memwatch: 메모리 사용량을 모니터링, 메모리 누수 추적

# 6. **Next.js 환경 디버깅하기**

- 디버그 모드 실행 옵션: NODE_OPTIONS='--inspect'
- 서버 트래픽 유입
  - 오픈소스 ab 사용: 웹서버 성능 검사 도구
  - 가짜 요청을 여러번 날려서
- 메모리 누수 지점(프론트 서버 메모리 누수 확인 방법)
  - e.g. 함수 내부에서 외부 스코프의 변수에 의존하는 경우
  - getServerSideProps처럼 페이지 접근 요청이 있을 때마다 실행되는 함수 내에서는 최대한 부수 효과가 없는 순수 함수로 구현해야 한다.
