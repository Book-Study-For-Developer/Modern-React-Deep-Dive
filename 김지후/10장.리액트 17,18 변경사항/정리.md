# 리액트 17 버전 살펴보기

### 1. 리액트의 점진적인 업그레이드

- React 16과 호환 가능
  - React 17 애플리케이션 내부에 React 16을 게으르게(lazy) 불러온다. 이 과정에서 React 16을 위한 별도의 루트 요소를 만들고, 여기에 불러온 React 16 모듈을 렌더링하는 구조

### 2. 이벤트 위임 방식의 변경

- document -> 리액트 최상단 요소
  ![react_17_delegation](https://ko.legacy.reactjs.org/static/bb4b10114882a50090b8ff61b3c4d0fd/31868/react_17_delegation.png)
- 각 이벤트는 해당 리액트 컴포넌트 트리 수준으로 격리되므로 이벤트 버블링으로 인한 혼선을 방지할 수 있다.
  - `stopPropagation`를 호출해도 같은 요소에 묶인 다른 이벤트 리스너들은 그대로 호출된다. 따라서 React 16에서 컴포넌트 루트가 아래처럼 나뉘었고, '특정 루트'에 대한 이벤트 전파를 막고 싶을지라도 모든 이벤트가 document에 등록되므로 불가능하다.
  ```html
  <div id="React-16-14">
    <div id="React-16-8"></div>
    <div></div>
  </div>
  ```

### 3. import React from 'react'가 더이상 필요 없다.

- 기존에는 JSX 변환을 위해 `import React from 'react'`가 필요했으나 리액트 17부터는 필요없다.
- React 17부터 바벨 변환시 React.createElement가 사라졌고, jsx 변환에 필요한 `react/jsx-runtime` 모듈을 내부적으로 호출한다.
- `npx react-codemod update-react-imports`: 기존 소스코드의 `import React from 'react'` 삭제
- 추후 쓰이지 않게 하려면 ESLint로 강제할 수도 있음
- tsconfig.json의 jsx를 `react-jsx`로 변경하면 해당 방식으로 JSX 변환

### 4. 그 밖의 주요 변경 사항

- 이벤트 풀링 제거
  - 이벤트 풀링은 이벤트가 발생할 때마다 새로운 이벤트 객체를 생성하는 대신, 이미 사용된 이벤트 객체를 '풀(pool)'에 저장하고 필요할 때 재사용하는 것을 의미. 이벤트 객체를 재사용하기 위해 사용된 개념
  - 해당 시스템에서는 이벤트 핸들러 함수가 호출되고 나면 해당 이벤트 객체의 모든 속성이 null로 설정되는데, 비동기적으로 이벤트 객체에 접근하려고 하면 문제가 발생해 `e.persist()` 같은 처리가 필요했음
- useEffect 클린업 함수의 비동기 실행
- 컴포넌트의 undefined 반환에 대한 일관적인 처리
  - 컴포넌트, forwardRef, memo에서 undefined 반환시 에러
  - React 18에서는 에러 발생 x

# 리액트 18 버전 살펴보기

### 1. 새로 추가된 훅 살펴보기

### 2. react-dom/client

### 3. react-dom/server

### 4. 자동 배치(Automatic Batchinig)

### 5. 더욱 엄격해진 엄격 모드

### 6. Suspense 기능 강화
